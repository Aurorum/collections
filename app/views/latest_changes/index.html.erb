<% content_for :title, "#{subtopic.title}: latest documents" %>
<% content_for :page_title do %>
  <span><%= subtopic.title %></span>: latest documents
<% end %>

<% content_for :meta_section do %>
  <meta name="govuk:section" content="<%= meta_section %>">
<% end %>

<% content_for :breadcrumbs do %>
  <%= render partial: 'govuk_component/breadcrumbs',
    locals: hardcoded_breadcrumbs %>
<% end %>

<%= render(
  layout: "subtopics/subtopic",
  locals: {
    subtopic: subtopic,
    organisations: organisations(subtopic.content_id),
    link_to_latest_feed: false,
  }) do %>
  <ul class="changed-documents">
    <% subtopic.changed_documents.each do |document| -%>
      <li>
        <h3><a href="<%= document.base_path %>"><%= document.title %></a></h3>

        <% if document.public_updated_at %>
          <time class="updated-at" datetime="<%= document.public_updated_at.iso8601 %>">
            <%= document.public_updated_at.strftime("%-d %B %Y") %>
          </time>
        <% end %>

        <% if document.change_note %>
          <p>
            <%= document.change_note %>
          </p>
        <% end %>
      </li>
    <% end -%>
  </ul>

  <ul class="previous-next-navigation">
    <% if pagination_presenter.previous_page? %>
      <li class="previous">
        <%= link_to pagination_presenter.previous_page_path do %>
          Previous <span class="visuallyhidden">page</span>
          <span class="page-numbers">
            <%= pagination_presenter.previous_page_number %> of
            <%= pagination_presenter.total_pages %>
          </span>
        <% end %>
      </li>
    <% end %>

    <% if pagination_presenter.next_page? %>
      <li class="next">
        <%= link_to pagination_presenter.next_page_path do %>
          Next <span class="visuallyhidden">page</span>
          <span class="page-numbers">
            <%= pagination_presenter.next_page_number %> of
            <%= pagination_presenter.total_pages %>
          </span>
        <% end %>
      </li>
    <% end %>
  </ul>
<% end %>
