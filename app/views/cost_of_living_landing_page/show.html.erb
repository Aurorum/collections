<%= render partial: "cost_of_living_landing_page/components/shared/meta_tags", locals: {
  metadata: content.metadata
} %>

<% content_for :title, content.page_title %>

<%
  accordion_contents = content.body[:accordion_content].map.with_index do |list, list_index|
    {
      heading: {
        text: list[:heading],
      },
      content: {
        html: render(partial: "links", locals: {
          presenter: content,
          accordion_heading: list[:heading],
          list: list[:content],
          list_index: list_index,
        }),
      },
      data_attributes: {
        "track-count": "accordionSection",
        "track-options": {
          "dimension114": list_index + 1
        },
        ga4: {
          event_name: 'select_content',
          type: 'accordion',
          text: list[:heading],
          index: list_index + 1,
          index_total: content.body[:accordion_content].map.size,
        }
      },
    }
  end
%>

<% content_for :breadcrumbs do %>
  <%= render "shared/browse_breadcrumbs", {
    column_two_thirds: true
  } %>
<% end %>

<%= render "shared/browse_header", {
    two_thirds: true
  } do %>

  <h1 class="browse__heading govuk-heading-xl">
    <%= content.header[:heading] %>
  </h1>
  <p class="gem-c-lead-paragraph gem-c-lead-paragraph--inverse govuk-!-margin-bottom-6">
    <%= content.header[:lede] %>
  </p>

  <%= render 'govuk_publishing_components/components/action_link', {
    white_arrow: true,
    href: content.header[:href],
    text: content.header[:link_text],
    mobile_subtext: true,
    light_text: true,
    data: {
      module: "gem-track-click",
      track_category: "pageElementInteraction",
      track_action: "Header",
      track_label: content.header[:href],
    }
  } %>

<% end %>

<div class="colhub__announcement">
  <div class="govuk-width-container">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
          <%= render "govuk_publishing_components/components/heading", {
            text: content.announcements[:heading],
            padding: true
          } %>
          <% content.announcements[:body].each do | body | %>
            <p class="govuk-body">
              <%= body[:content] %>
              <a class="govuk-link" href="<%= body[:href] %>">
                <%= body[:link_text] %>
              </a>
            </p>
          <% end %>
      </div>
    </div>
  </div>
</div>

<div class="govuk-width-container">
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <div class="browse__section">

        <div data-module="toggle-attribute">
          <%= render "govuk_publishing_components/components/accordion", {
            track_show_all_clicks: true,
            track_sections: true,
            data_attributes: {
              module: "ga4-event-tracker",
            },
            data_attributes_show_all: {
              "ga4": {
                event_name: "select_content",
                type: "accordion",
                index: 0,
                index_total: content.body[:accordion_content].map.size
              }.to_json,
            },
            items: accordion_contents,
          } %>
        </div>
      </div>
    </div>
  </div>
</div>
